#This is a basic Library management system that allows users to track books, authors, patrons(library users), and book transactions (such as borrowing and returning books). 



#Library Management System
from datetime import datetime

class Author: 
   def __init__(self, name: str, nationality: str):   #Initializes an author with a name and nationality 
       self.name = name                               #Allows each author to have a unique name passed onto the function
       self.nationality = nationality                 #Allows each author to have a unique nationality passed onto the function
        
   def __str__(self): 
       return f"{self.name}, {self.nationality}"  #Returns a string representation of the author

	#The describe method sounds like it has the same function as the ___str__ method so I won't include it right now

class Book: 
   def __init__(self, title: str, author: Author, genre: str, available: bool):  #Initializes a book with its title, author, genre, availability and time
       self.title = title
       self.author = author
       self.genre = genre
       self.available = available
       self.borrowed_date = None
       self.returned_date = None

   def borrow(self):        #Marks the book as borrowed (changes availability status)
       if self.available:
        self.available = False
        self.borrowed_date = datetime.now()
        return f"{self.title} has been borrowed at {self.borrowed_date}"


   def return_book(self):   #Marks the book as returned record return date
       if not self.available:
          self.available = True
          self.returned_date = datetime.now()
          return f"{self.title} by {self.author} has been returned at {self.returned_date}"
       else:
            return f"{self.title} by {self.author} has not been borrowed"

   def borrow_duration(self):
        if self.borrowed_date and self.returned_date:
            duration = self.returned_date - self.borrowed_date
            return f"The book was borrowed for {duration}"
        else:
            return f"This book has not been borrowed"

   def __str__(self):
       return f"{self.title} by {self.author}"
       
class Patron: 
   def __init__(self, name: str, email: str):  #Initializes a patron with name and email
       self.name = name
       self.email = email
       self.borrowed_books = []
    
   def borrow_book(self, book: Book):          #Allows a patron to borrow a book
       if book.available:
          book.borrow()
          self.borrowed_books.append(book)
          print (f"{book.title} has been borrowed by {self.name}")
       else:
        print (f"{book.title} is currently not available to borrow")
    
   def return_book(self, book: Book):          #Allows a patron to return a borrowed book
       if book in self.borrowed_books:
        book.return_book()
        self.borrowed_books.remove(book)
        print (f"{book.title} has been returned by {self.name}")
       else:
        print (f"{book.title} has not been borrowed by {self.name}")

   def __str__(self):                         #Display patron details
    return f"{self.name}, {self.email}"

class Library: 
   def __init__(self):  #Initializes an empty library
    self.book_Library = []
    self.patron_reg = []

   def add_book(self, book: Book):  #Adds a book to the library
       self.book_Library.append(book)
       print (f"This book has been added to the Library database")
 
   def register_patron(self, patron: Patron):  #Registers a new patron
       self.patron_reg.append(patron)
       print (f"Patron {patron} has been registered")

   def __str__(self):
       return f"{self.patron_reg}"
 
   def list_books(self):    #Lists all books in the library
       for book in self.book_Library:
           print (f"~ {book.title} by {book.author}")
   
   def display_transactions(self): #Implement a method to display all transactions (borrowed books)
       print(f"Books Borrowed: ")
       borrowed_List = False
       for patron in self.patron_reg:
           for book in patron.borrowed_books:
            print (f"~ {book.title} by {book.author}")
            borrowed_List = True
       if not borrowed_List:
            print (f"There are no books being borrowed right now")

author1 = Author("J.K Rowling", "United Kingdom")
author2 = Author("George Orwell", "India")

book1 = Book("Harry Potter", author1, "Fantasy", True)
book2 = Book("1984", author2, "Dystopian", True)

patron1 = Patron("alice", "alicewonderland@umsl.edu")

patron1.borrow_book(book1)
patron1.return_book(book1)
print(book1)
print(book2)
